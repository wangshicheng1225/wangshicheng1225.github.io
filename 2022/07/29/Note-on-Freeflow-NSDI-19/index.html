<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/android-chrome-512x512.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"wangshicheng1225.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.12.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="IntroA virtualization framework supporting container in RDMA network Motivation Containerized cloud provides lightweight Isolation, Portability and Controllability (Sec. Intro.) The kernel-bypass para">
<meta property="og:type" content="article">
<meta property="og:title" content="Note on Freeflow [NSDI&#39;19]">
<meta property="og:url" content="http://wangshicheng1225.github.io/2022/07/29/Note-on-Freeflow-NSDI-19/index.html">
<meta property="og:site_name" content="Shicheng Wang">
<meta property="og:description" content="IntroA virtualization framework supporting container in RDMA network Motivation Containerized cloud provides lightweight Isolation, Portability and Controllability (Sec. Intro.) The kernel-bypass para">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://wangshicheng1225.github.io/2022/07/29/Note-on-Freeflow-NSDI-19/SR-IOVvirtulization.png">
<meta property="og:image" content="http://wangshicheng1225.github.io/2022/07/29/Note-on-Freeflow-NSDI-19/fig2.png">
<meta property="og:image" content="http://wangshicheng1225.github.io/2022/07/29/Note-on-Freeflow-NSDI-19/fig4.png">
<meta property="article:published_time" content="2022-07-29T12:20:43.000Z">
<meta property="article:modified_time" content="2022-07-29T12:20:43.035Z">
<meta property="article:author" content="Shicheng Wang">
<meta property="article:tag" content="Note">
<meta property="article:tag" content="Data Center">
<meta property="article:tag" content="RDMA">
<meta property="article:tag" content="Virtulization">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://wangshicheng1225.github.io/2022/07/29/Note-on-Freeflow-NSDI-19/SR-IOVvirtulization.png">


<link rel="canonical" href="http://wangshicheng1225.github.io/2022/07/29/Note-on-Freeflow-NSDI-19/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://wangshicheng1225.github.io/2022/07/29/Note-on-Freeflow-NSDI-19/","path":"2022/07/29/Note-on-Freeflow-NSDI-19/","title":"Note on Freeflow [NSDI'19]"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Note on Freeflow [NSDI'19] | Shicheng Wang</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Shicheng Wang</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Alea iacta est</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="categories fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Intro"><span class="nav-number">1.</span> <span class="nav-text">Intro</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Motivation"><span class="nav-number">2.</span> <span class="nav-text">Motivation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Background"><span class="nav-number">3.</span> <span class="nav-text">Background</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Virtulization"><span class="nav-number">3.1.</span> <span class="nav-text">Virtulization</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Key-design"><span class="nav-number">4.</span> <span class="nav-text">Key design</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Overview"><span class="nav-number">4.1.</span> <span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Transparency"><span class="nav-number">4.2.</span> <span class="nav-text">Transparency</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#High-performance"><span class="nav-number">4.3.</span> <span class="nav-text">High-performance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Communication-between-FFL-and-FFR"><span class="nav-number">4.4.</span> <span class="nav-text">Communication between FFL and FFR</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reviews"><span class="nav-number">5.</span> <span class="nav-text">Reviews</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Shicheng Wang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://wangshicheng1225.github.io/2022/07/29/Note-on-Freeflow-NSDI-19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Shicheng Wang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shicheng Wang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Note on Freeflow [NSDI'19] | Shicheng Wang">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Note on Freeflow [NSDI'19]
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-07-29 20:20:43" itemprop="dateCreated datePublished" datetime="2022-07-29T20:20:43+08:00">2022-07-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Notes/" itemprop="url" rel="index"><span itemprop="name">Notes</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>A virtualization framework supporting container in RDMA network</p>
<h2 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h2><ul>
<li>Containerized cloud provides lightweight <em>Isolation</em>, <em>Portability</em> and <em>Controllability</em> (Sec. Intro.)</li>
<li>The kernel-bypass paradigm of RDMA puts difficulty on virtulization<ul>
<li><code>It is difficult to modify the control plane states (e.g., routes) in hardware in shared cloud environments, while it is also hard to control the data path since traffic directly goes between RAM and NIC via PCIe bus</code></li>
<li><code>when they run in shared clouds, they have to fundamentally eschew the performance benefits afforded by RDMA. Naturally, using dedicated clusters to run an application is, however, not cost efficient both for providers or for customers.</code></li>
<li>Current public cloud (Azure, even AWS) usually sell nearly bare-metal RDMA instances. (What about Aliyun eRDMA?)</li>
</ul>
</li>
<li>Propose a tranparent and high-performance virtulization framework for containerized RDMA network.</li>
</ul>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><h3 id="Virtulization"><a href="#Virtulization" class="headerlink" title="Virtulization"></a>Virtulization</h3><ul>
<li><em>Host mode</em> networking containers<br>Containers use their host’s IP and port space, and communicate like an ordinary process in the host OS. Poor isolation and portability.</li>
<li><em>Virtual mode</em> networking.<ul>
<li>VSwitch (hardware-offloaded or on software) on a physical device.</li>
<li>Strawman SR-IOV RDMA Vswitch has fundamental portability limitations (hard configuration migration).<img src="/2022/07/29/Note-on-Freeflow-NSDI-19/SR-IOVvirtulization.png" class="" title="SR-IOV RDMA Vswitch 100 100"></li>
</ul>
</li>
</ul>
<h2 id="Key-design"><a href="#Key-design" class="headerlink" title="Key design"></a>Key design</h2><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>The key design can be easily get through the architecutre figure.</p>
<img src="/2022/07/29/Note-on-Freeflow-NSDI-19/fig2.png" class="" title="Overveiw 100 100">

<img src="/2022/07/29/Note-on-Freeflow-NSDI-19/fig4.png" class="" title="Architecture 100 100">
<!-- ![Overveiw](fig2.png) -->


<h3 id="Transparency"><a href="#Transparency" class="headerlink" title="Transparency"></a>Transparency</h3><p>Key insight: Containers are essentially processes, and they can easily share resources like memory and file descriptors with FreeFlow.<br>Intercept the <strong>verb</strong> to consturct a <strong>mapping</strong> on the Freeflow.</p>
<h3 id="High-performance"><a href="#High-performance" class="headerlink" title="High-performance"></a>High-performance</h3><p>Leverage a zero-copy design for throughput (§4.3), and a shared memory inter-process channel with CPU spinning for latency (§5.2 and Fig.6 in the paper)</p>
<h3 id="Communication-between-FFL-and-FFR"><a href="#Communication-between-FFL-and-FFR" class="headerlink" title="Communication between FFL and FFR"></a>Communication between FFL and FFR</h3><p>FFR intercepts the calls between Verbs library and NIC drivers by proposing a file descriptor lib.<br>Propose a <em>fast path</em> using polling with a dedicated CPU.</p>


<h2 id="Reviews"><a href="#Reviews" class="headerlink" title="Reviews"></a>Reviews</h2><ol>
<li>Propose a virtulization framework for container level RDMA</li>
<li>No security issues such as leaking the data or mem key to other containers.</li>
<li>No consideration on performance isolation. Only container-level isolation for portable control problem.</li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Note/" rel="tag"># Note</a>
              <a href="/tags/Data-Center/" rel="tag"># Data Center</a>
              <a href="/tags/RDMA/" rel="tag"># RDMA</a>
              <a href="/tags/Virtulization/" rel="tag"># Virtulization</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/07/29/Note-on-Justitia/" rel="prev" title="Note on Justitia">
                  <i class="fa fa-chevron-left"></i> Note on Justitia
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shicheng Wang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
