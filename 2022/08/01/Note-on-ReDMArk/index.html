<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/android-chrome-512x512.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"wangshicheng1225.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.12.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="OverviewSummarize the security issues in RDMA network. Threat Model off-path, no root root, able to fabricate and inject messages. On-path network device Covert path to stole information.  Security An">
<meta property="og:type" content="article">
<meta property="og:title" content="Note on ReDMArk [Security&#39;21]">
<meta property="og:url" content="http://wangshicheng1225.github.io/2022/08/01/Note-on-ReDMArk/index.html">
<meta property="og:site_name" content="Shicheng Wang">
<meta property="og:description" content="OverviewSummarize the security issues in RDMA network. Threat Model off-path, no root root, able to fabricate and inject messages. On-path network device Covert path to stole information.  Security An">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-08-01T02:59:09.000Z">
<meta property="article:modified_time" content="2022-08-01T06:50:35.138Z">
<meta property="article:author" content="Shicheng Wang">
<meta property="article:tag" content="Note">
<meta property="article:tag" content="Security">
<meta property="article:tag" content="Data Center">
<meta property="article:tag" content="RDMA">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://wangshicheng1225.github.io/2022/08/01/Note-on-ReDMArk/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://wangshicheng1225.github.io/2022/08/01/Note-on-ReDMArk/","path":"2022/08/01/Note-on-ReDMArk/","title":"Note on ReDMArk [Security'21]"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Note on ReDMArk [Security'21] | Shicheng Wang</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Shicheng Wang</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Alea iacta est</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="categories fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Overview"><span class="nav-number">1.</span> <span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Threat-Model"><span class="nav-number">2.</span> <span class="nav-text">Threat Model</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Security-Analysis-on-IB-Arch"><span class="nav-number">3.</span> <span class="nav-text">Security Analysis on IB Arch</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Memory-Protection-Keys"><span class="nav-number">3.1.</span> <span class="nav-text">Memory Protection Keys</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Memory-Allocation-Randomness"><span class="nav-number">3.2.</span> <span class="nav-text">Memory Allocation Randomness</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#QP-Number-Identifiers-amp-Packet-Sequence-Numbers"><span class="nav-number">3.3.</span> <span class="nav-text">QP Number Identifiers &amp; Packet Sequence Numbers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Other-Weakness"><span class="nav-number">3.4.</span> <span class="nav-text">Other Weakness</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Attack"><span class="nav-number">4.</span> <span class="nav-text">Attack</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Packet-Injection-using-Impersonation"><span class="nav-number">4.1.</span> <span class="nav-text">Packet Injection using Impersonation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DoS-Attack-by-Transiting-QPs-to-an-Error-State"><span class="nav-number">4.2.</span> <span class="nav-text">DoS Attack by Transiting QPs to an Error State</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Unauthorized-Memory-Access"><span class="nav-number">4.3.</span> <span class="nav-text">Unauthorized Memory Access</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DoS-Attack-based-on-Queue-Pair-Allocation-Resource-Exhaustion"><span class="nav-number">4.4.</span> <span class="nav-text">DoS Attack based on Queue Pair Allocation Resource Exhaustion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dos-on-end-resources-exhaustion"><span class="nav-number">4.5.</span> <span class="nav-text">Dos on end-resources exhaustion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Facilitating-Attacks-using-RDMA"><span class="nav-number">4.6.</span> <span class="nav-text">Facilitating Attacks using RDMA</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vulnerability-Assessment-of-Open-Source-RDMA-System"><span class="nav-number">5.</span> <span class="nav-text">Vulnerability Assessment of Open-Source RDMA System</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Security-mechanism"><span class="nav-number">6.</span> <span class="nav-text">Security mechanism</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Experimantal-Setup"><span class="nav-number">7.</span> <span class="nav-text">Experimantal Setup</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RDMA-Related-Work"><span class="nav-number">8.</span> <span class="nav-text">RDMA Related Work</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reviews"><span class="nav-number">9.</span> <span class="nav-text">Reviews</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Shicheng Wang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://wangshicheng1225.github.io/2022/08/01/Note-on-ReDMArk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Shicheng Wang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shicheng Wang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Note on ReDMArk [Security'21] | Shicheng Wang">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Note on ReDMArk [Security'21]
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-08-01 10:59:09 / Modified: 14:50:35" itemprop="dateCreated datePublished" datetime="2022-08-01T10:59:09+08:00">2022-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Notes/" itemprop="url" rel="index"><span itemprop="name">Notes</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Summarize the security issues in RDMA network.</p>
<h2 id="Threat-Model"><a href="#Threat-Model" class="headerlink" title="Threat Model"></a>Threat Model</h2><ol>
<li>off-path, no root</li>
<li>root, able to fabricate and inject messages.</li>
<li>On-path network device</li>
<li>Covert path to stole information.</li>
</ol>
<h2 id="Security-Analysis-on-IB-Arch"><a href="#Security-Analysis-on-IB-Arch" class="headerlink" title="Security Analysis on IB Arch"></a>Security Analysis on IB Arch</h2><h3 id="Memory-Protection-Keys"><a href="#Memory-Protection-Keys" class="headerlink" title="Memory Protection Keys"></a>Memory Protection Keys</h3><ul>
<li>Memory Protection Key Randomness: <em>rkey</em> entropy and prediction probability analysis</li>
<li>Static Initialization State for Key Generation</li>
<li>Shared Key Generator. “If multiple RDMA applications are running on the same service the prediction of rkeys of other applications based on own rkeys is trivial as they have been generated using the same key generator.”</li>
</ul>
<h3 id="Memory-Allocation-Randomness"><a href="#Memory-Allocation-Randomness" class="headerlink" title="Memory Allocation Randomness"></a>Memory Allocation Randomness</h3><p>If memory is allcoated side-by-side, it can be easy to predict.</p>
<h3 id="QP-Number-Identifiers-amp-Packet-Sequence-Numbers"><a href="#QP-Number-Identifiers-amp-Packet-Sequence-Numbers" class="headerlink" title="QP Number Identifiers &amp; Packet Sequence Numbers"></a>QP Number Identifiers &amp; Packet Sequence Numbers</h3><ul>
<li>Linearly Increasing QP Numbers</li>
<li>Fixed Starting Packet Sequence Number (PSN)</li>
</ul>
<h3 id="Other-Weakness"><a href="#Other-Weakness" class="headerlink" title="Other Weakness"></a>Other Weakness</h3><ul>
<li>Limited Attack Detection Capabilities: No CPU intervention</li>
<li>No encryption&#x2F;authentication</li>
<li>Single Protection Domain for all QPs.</li>
<li>Implicit ODP:<ul>
<li>“If ODP is enabled, an attacker can remotely access the entire memory space of a process resulting in high attack potential.”</li>
<li>RDMA integrated with other memory access acceleration can have high security risk. (e.g., DDIO)</li>
</ul>
</li>
</ul>
<p>To summarize: Hardware NIC has poorer isolation or security mechanism than CPU, due to the performance requirement or resource limit.</p>
<h2 id="Attack"><a href="#Attack" class="headerlink" title="Attack"></a>Attack</h2><h3 id="Packet-Injection-using-Impersonation"><a href="#Packet-Injection-using-Impersonation" class="headerlink" title="Packet Injection using Impersonation"></a>Packet Injection using Impersonation</h3><ul>
<li>R&#x2F;W unauthorized content</li>
<li>Leading the session to error state.</li>
</ul>
<h3 id="DoS-Attack-by-Transiting-QPs-to-an-Error-State"><a href="#DoS-Attack-by-Transiting-QPs-to-an-Error-State" class="headerlink" title="DoS Attack by Transiting QPs to an Error State"></a>DoS Attack by Transiting QPs to an Error State</h3><h3 id="Unauthorized-Memory-Access"><a href="#Unauthorized-Memory-Access" class="headerlink" title="Unauthorized Memory Access"></a>Unauthorized Memory Access</h3><h3 id="DoS-Attack-based-on-Queue-Pair-Allocation-Resource-Exhaustion"><a href="#DoS-Attack-based-on-Queue-Pair-Allocation-Resource-Exhaustion" class="headerlink" title="DoS Attack based on Queue Pair Allocation Resource Exhaustion"></a>DoS Attack based on Queue Pair Allocation Resource Exhaustion</h3><h3 id="Dos-on-end-resources-exhaustion"><a href="#Dos-on-end-resources-exhaustion" class="headerlink" title="Dos on end-resources exhaustion"></a>Dos on end-resources exhaustion</h3><h3 id="Facilitating-Attacks-using-RDMA"><a href="#Facilitating-Attacks-using-RDMA" class="headerlink" title="Facilitating Attacks using RDMA"></a>Facilitating Attacks using RDMA</h3><p>“As RDMA read and write operations do not require any interaction by a remote host’s CPU V7 , they allow an attacker to “silently” read and write data.”</p>
<ul>
<li>W: inject code</li>
<li>R: By continuously sweeping the readable memory, the attacker can eavesdrop on sensitive data of applications.</li>
</ul>
<p>Is in-network filter, or even DPI motivated?</p>
<h2 id="Vulnerability-Assessment-of-Open-Source-RDMA-System"><a href="#Vulnerability-Assessment-of-Open-Source-RDMA-System" class="headerlink" title="Vulnerability Assessment of Open-Source RDMA System"></a>Vulnerability Assessment of Open-Source RDMA System</h2><p>Some RDMA application such as distributed&#x2F;remote storage&#x2F;key-value systems.<br>Refer in Sec. 6</p>
<h2 id="Security-mechanism"><a href="#Security-mechanism" class="headerlink" title="Security mechanism"></a>Security mechanism</h2><p>Refer in Sec. 7</p>
<h2 id="Experimantal-Setup"><a href="#Experimantal-Setup" class="headerlink" title="Experimantal Setup"></a>Experimantal Setup</h2><ul>
<li>Server Cluster with Broadcom&#x2F;Mellanox NIC</li>
<li>Public cloud (H16r in Azure)</li>
<li>software-based RoCE</li>
</ul>
<h2 id="RDMA-Related-Work"><a href="#RDMA-Related-Work" class="headerlink" title="RDMA Related Work"></a>RDMA Related Work</h2><ul>
<li>Architectural Mode: RFC 5042</li>
<li>Side-channel Attack: Net-CAT (S&amp;P ‘20); Pythia (Sec ‘19)</li>
<li>Storage application: Securing RDMA for highperformance datacenter storage systems. (HotCloud ‘20)</li>
</ul>
<h2 id="Reviews"><a href="#Reviews" class="headerlink" title="Reviews"></a>Reviews</h2><ul>
<li>Most RDMA security issues exist in the “system-level” such as using unauthorized access to memory regions or disrupting communication using DoS. Less attacks on “Network-layer”</li>
<li>“Furthermore, specific Mellanox NICs support raw Ethernet programming with a kernel bypass [2]”</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Note/" rel="tag"># Note</a>
              <a href="/tags/Security/" rel="tag"># Security</a>
              <a href="/tags/Data-Center/" rel="tag"># Data Center</a>
              <a href="/tags/RDMA/" rel="tag"># RDMA</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/07/29/Note-on-Freeflow-NSDI-19/" rel="prev" title="Note on Freeflow [NSDI'19]">
                  <i class="fa fa-chevron-left"></i> Note on Freeflow [NSDI'19]
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shicheng Wang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
